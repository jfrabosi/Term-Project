<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Term Project - ME 405, Tub 4: Term Project - ME 405, Tub 4</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Term Project - ME 405, Tub 4
   </div>
   <div id="projectbrief">Pancake Plotter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Term Project - ME 405, Tub 4 </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_1"></a>
SOFTWARE OVERVIEW</h1>
<p >This section will cover the various drivers used in our system as well as what tasks they were utilized in. The tasks themselves be discussed in a later section. </p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md0"></a>
MOTOR DRIVER</h2>
<p >The motor driver script contains class files that allow us to apply pwm to our dc motors. Since we are utilizing two diffrent motor shield we have two separte class files since each motor shield utilizes a diffrent amount of pins. The motor driver is utilized in all of outr motor tasks in order to apply a duty cycle.</p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md1"></a>
ENCODER DRIVER</h2>
<p >The encoder driver script contains a class file that allows us perform various functions with the encoders on the motors. These functions enclude reading the position of the encoder, zeroing the position of the encoder and overwriting the position of the encoder wit ha custom value. The encoder driver is used in all of our motor tasks in order to locate read out our transverse and radial positions. </p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md2"></a>
CONTROLLER</h2>
<p >The controller script contains a class file that allows us to perform PID control. It contains functions for setting our gain values and setpoints. It also contains a function to compute the total error in our system. This file is used by our motor tasks in order to impliment positional control. </p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md3"></a>
LIMIT SWITCH</h2>
<p >The limit switch script is a short script that contains a class file that allows us to check the status of our limit switches. It contains a function that will return the pin value when called. This file is used in our limit switch tasks in order to update key flag variables depending on whether or not the limit switches are actuated. </p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md4"></a>
G-CODE</h2>
<p >The gcode_convert script is a function file that contains a function that takes a .nc file, converts it to three seperate lists containing cartesian coordinates, and then conversts those lists to cartesian coordinates. This file is used in our execution script in order to create the lists that will be used by our various motor tasks.</p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md5"></a>
TASK_SHARE &amp; COTASK</h2>
<p >The task_share and cotask scripts were scrips that were shared with us in lecture in order to imoliment cooperative multitasking. The task_share file allows us to create shared variables to be used among our generators while the cotask file allows us to turn our generators into tasks and run them simultaneously.</p>
<h1><a class="anchor" id="sec_2"></a>
TASK STRUCTURE</h1>
<p >This section will cover the tasks that we plan on utilizing for our 2.5 axis machine. The main taks that we will need include a G-Code task thatconverts G-code into usable coordinates, a radial motor task, a transverse motor task, and a syringe motor task. The task diagram below shows how we plan on implimenting these tasks into our design through the use of share objects. each task will be discussed more in depth in the following sections.</p>
<p ><img src="Task_Diagram.jpg" alt="" class="inline"/></p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md6"></a>
RADIAL LIMIT SWITCH TASK</h2>
<p >The radial limit switch task continuouslly checks to see if the limit switch for the radial motor has been actuated. This is accomplished through the use of a shared flag variable. When the task is initialized the value of this shared variable is set to zero. When the limit switch is finally actuated, the value of the shared variable is changed to one, this is then used to start the plotting portion for the radial motor task.</p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md7"></a>
TRANSVERSE LIMIT SWITCH TASK</h2>
<p >The transverse limit switch task continuouslly checks to see if the limit switch for the transverse motor has been actuated. This is accomplished through the use of a shared flag variable. When the task is initialized the value of this shared variable is set to zero. When the limit switch is finally actuated, the value of the shared variable is changed to one, this is then used to start the plotting portion for the transverse motor task. </p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md8"></a>
EXTRUSION LIMIT SWITCH TASK</h2>
<p >The extrusion limit switch task continuously checks to see if the limit switch for the extrusion motor task has benn actuated.</p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md9"></a>
RADIAL MOTOR TASK</h2>
<p >The radial motor task will be responsible for the radial motion of our nozzle. In order to accomplish this the radial motion will first locate itself using the limit switch located on its path. When the task first runs the radial motor will move the arm slightly away from, and then towards the limit switch until it makes contact with it. Once the arm makes contact with the limit switch, the position of the encoder is updated to correspond with the the position of the limit switch. It will also wait for the transverese motor to make contact with its limit switch before proceeding. This will all be done in the initialization state S0 shown in the FSM below. Once contact with the radial and transverse limit switches has been made, the flag variables for each of those motors will be changed to one, and thus the task will transition into the next state S1, which is locating the radial coordinates. In this state, the task will make its way through a provided list of coordinates using a PI controller for positional control in order to get as colse to the desired value as it can. A constant duty cycle will be applied to the motor as it moves from index to index. In case the radial motor reaches its desired index value before the transverse motor, it will enter an idler state, S2, where it will wait for the trnasverse motor to reach its index value before continuing. This state also uses the aforementioned flag variables to make sure that each motor has reached its appropriate index value.</p>
<p ><img src="Rad_MotorFSM.jpg" alt="" class="inline"/></p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md10"></a>
TRANSVERSE MOTOR TASK</h2>
<p >The transverse motor task will be responsible for the transverse motion of our nozzle, and is very similar in functionality to the radial motor task. The task begins by locating itself in the initialization state S0 in the same manner as the radial motor task, the only difference being that this task is also responsible for updating the flag variable for the extrusion task so that it can begin its cycle. After the task has gone through the initialization state, it moves onto S1, locating coordinates. In the same manner as the radial motor task, this tak also has its own list that it iterates through using positional control to get as close to the desired values as it possibly can. This task also contains an idler state in case it reaches its index value before the radial motor task. Once both tasks reach their index value the flag variables are updated and they move onto the next value in their respective lists.</p>
<p ><img src="Trans_MotorFSM.jpg" alt="" class="inline"/></p>
<h2><a class="anchor" id=""></a>
</h2>
<h2><a class="anchor" id="autotoc_md11"></a>
EXTRUSION MOTOR TASK</h2>
<p >The extrusion motor task will be responsible for the actuation of syringe that will dispense our pancake batter onto the plotting surface. The task stats by first moving the motor to make sure that no pressure is being applied on the syringe. Once this is done, the task begins going through its list of actuation values. This list simply contains 0's and 1's, a one indicating to extrude batter. In order to make sure that batter is only extruded once the radial and transverse motor tasks have rached their proper locations, a shared index variable is used. This variable is sent to the extrusion task after both the radial and transverse motor tasks have reached their location, and it ensures that all three tasks are operating on the same index, and thus batter is only being extruded at the proper locations. Since the syringe we are using only holds 150 ml of batter, we used positional control to ensure that once the syringe has been supressed 150 ml, the motor will stop. We also used a constant feed rate for our extrusion motor. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
